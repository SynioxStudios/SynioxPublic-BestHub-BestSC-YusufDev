-- SYNÄ°OX PUBLIC | MUSCLE LEGENDS | ByYusuf | V1.0
-- Integrated fixes: corrected loadstring, separated auto-eat toggles, repaired rock auto-farm sections,
-- consolidated Players/LocalPlayer declarations, and other syntax/robustness fixes.

local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/Byhalis/Gui-v8/main/v2"))()

local window = library:AddWindow("SYNÄ°OX PUBLIC | MUSCLE LEGENDS | ByYusuf | V1.0", {
    main_color = Color3.fromRGB(0, 0, 0),
    min_size = Vector2.new(700, 750),
    can_resize = true,
})

local AutoFarm = window:AddTab("Farm")

AutoFarm:AddLabel("Complements to Farm")

-- Auto eat: two independent toggles for 30 and 60 minutes
local autoEat30Enabled = false
local autoEat60Enabled = false

local function eatProteinEgg()
    local player = game.Players.LocalPlayer
    local backpack = player:FindFirstChild("Backpack")
    local character = player.Character or player.CharacterAdded:Wait()

    if backpack then
        local egg = backpack:FindFirstChild("Protein Egg")
        if egg then
            egg.Parent = character
            pcall(function()
                if egg.Activate then egg:Activate() end
            end)
        end
    end
end

task.spawn(function()
    while true do
        if autoEat30Enabled then
            eatProteinEgg()
            task.wait(1800) -- 30 minutes
        else
            task.wait(1)
        end
    end
end)

AutoFarm:AddSwitch("ðŸ¥šAuto Eat Egg 30 Min", function(state)
    autoEat30Enabled = state
end)

task.spawn(function()
    while true do
        if autoEat60Enabled then
            eatProteinEgg()
            task.wait(3600) -- 60 minutes
        else
            task.wait(1)
        end
    end
end)

AutoFarm:AddSwitch("ðŸ¥š Auto Eat Egg 60 Min", function(state)
    autoEat60Enabled = state
end)

local repToggle = false

AutoFarm:AddSwitch("Auto Farm (Equip Any tool)", function(state)
    repToggle = state
    task.spawn(function()
        while repToggle do
            pcall(function()
                local args = { "rep" }
                game:GetService("Players").LocalPlayer:WaitForChild("muscleEvent"):FireServer(unpack(args))
            end)
            task.wait(0.2)
        end
    end)
end)

local folder1 = AutoFarm:AddFolder("Tools")

local weightOn = false
folder1:AddSwitch("Weight", function(bool)
    weightOn = bool
    task.spawn(function()
        while weightOn do
            local tool = game.Players.LocalPlayer.Backpack:FindFirstChild("Weight")
            if tool then
                tool.Parent = game.Players.LocalPlayer.Character
            end
            task.wait(0.1)
        end
    end)
end)

local pushupsOn = false
folder1:AddSwitch("Pushups", function(bool)
    pushupsOn = bool
    task.spawn(function()
        while pushupsOn do
            local tool = game.Players.LocalPlayer.Backpack:FindFirstChild("Pushups")
            if tool then
                tool.Parent = game.Players.LocalPlayer.Character
            end
            task.wait(0.1)
        end
    end)
end)

local handstandOn = false
folder1:AddSwitch("Handstand", function(bool)
    handstandOn = bool
    task.spawn(function()
        while handstandOn do
            local tool = game.Players.LocalPlayer.Backpack:FindFirstChild("Handstand")
            if tool then
                tool.Parent = game.Players.LocalPlayer.Character
            end
            task.wait(0.1)
        end
    end)
end)

local situpsOn = false
folder1:AddSwitch("Situps", function(bool)
    situpsOn = bool
    task.spawn(function()
        while situpsOn do
            local tool = game.Players.LocalPlayer.Backpack:FindFirstChild("Situps")
            if tool then
                tool.Parent = game.Players.LocalPlayer.Character
            end
            task.wait(0.1)
        end
    end)
end)

local function equipTool(toolName, character, backpack)
    local existingTool = character:FindFirstChildOfClass("Tool")
    if existingTool then
        existingTool.Parent = backpack
    end

    local tool = backpack:FindFirstChild(toolName) or character:FindFirstChild(toolName)
    if tool and tool.Parent ~= character then
        tool.Parent = character
    end
end

local function handleRock(rock, leftHand)
    if rock then
        pcall(function()
            rock.Size = Vector3.new(2, 1, 1)
            rock.Transparency = 1
            rock.CanCollide = false
        end)

        if rock:FindFirstChild("rockGui") then
            for _, v in pairs(rock.rockGui:GetChildren()) do
                if typeof(v) == "Instance" and v:IsA("GuiObject") then
                    v.Visible = false
                end
            end
        end

        for _, particle in ipairs({"rockEmitter", "hoopParticle", "lavaParticle"}) do
            if rock:FindFirstChild(particle) then
                pcall(function() rock[particle]:Destroy() end)
            end
        end

        if leftHand and leftHand:IsA("BasePart") then
            pcall(function() rock.CFrame = leftHand.CFrame end)
        end

        local touchPart = rock:FindFirstChild("TouchPart")
        if touchPart then
            if leftHand and leftHand:IsA("BasePart") then
                pcall(function() touchPart.CFrame = leftHand.CFrame end)
            end
            local fireTouch = Instance.new("RemoteEvent")
            fireTouch.Parent = rock
            pcall(function() fireTouch:FireServer(touchPart) end)
        end
    end
end

local function addRockAuto(rockLabel, neededDurability)
    -- helper to create a switch for different rocks
    Rock:AddSwitch(rockLabel, function(Value)
        local toggleName = "autoFarm_" .. rockLabel:gsub("%s+", "_")
        getgenv()[toggleName] = Value

        task.spawn(function()
            while getgenv()[toggleName] do
                task.wait()
                if not getgenv()[toggleName] then break end

                local player = game:GetService("Players").LocalPlayer
                local char = player.Character
                if not char then task.wait(0.5); continue end
                local left = char:FindFirstChild("LeftHand")
                local right = char:FindFirstChild("RightHand")

                local durability = player:FindFirstChild("Durability")
                if durability and durability.Value >= neededDurability then
                    for _, v in pairs(game:GetService("Workspace").machinesFolder:GetDescendants()) do
                        if v.Name == "neededDurability" and v.Value == neededDurability then
                            local rockParent = v.Parent
                            local rock = rockParent and rockParent:FindFirstChild("Rock")
                            if rock and left and right then
                                pcall(function()
                                    -- attempt touching the rock with hands
                                    firetouchinterest(rock, right, 0)
                                    firetouchinterest(rock, right, 1)
                                    firetouchinterest(rock, left, 0)
                                    firetouchinterest(rock, left, 1)
                                end)
                                -- ensure punch tool and fire server actions
                                gettool()
                            end
                        end
                    end
                end
                task.wait(0.1)
            end
        end)
    end)
end

local Rock = window:AddTab("Rock")

function gettool()
    local player = game.Players.LocalPlayer
    for i, v in pairs(player.Backpack:GetChildren()) do
        if v.Name == "Punch" and player.Character and player.Character:FindFirstChild("Humanoid") then
            pcall(function()
                player.Character.Humanoid:EquipTool(v)
            end)
        end
    end
    pcall(function()
        game:GetService("Players").LocalPlayer.muscleEvent:FireServer("punch", "leftHand")
        game:GetService("Players").LocalPlayer.muscleEvent:FireServer("punch", "rightHand")
    end)
end

-- Rock switches with their required durability values:
addRockAuto("Tiny Rock", 0)
addRockAuto("Starter Rock", 100)
addRockAuto("Legend Beach Rock", 5000)
addRockAuto("Frozen Rock", 150000)
addRockAuto("Mythical Rock", 400000)
addRockAuto("Eternal Rock", 750000)
addRockAuto("Legend Rock", 1000000)
addRockAuto("Muscle King Rock", 5000000)
addRockAuto("Jungle Rock", 10000000)

-- Rebirths tab
local rebirths = window:AddTab("Rebirths")

local targetRebirthValue = 1
local function updateStats()
    -- placeholder: if there is a UI update function for stats, call it; otherwise noop
end

rebirths:AddTextBox("Rebirth Target", function(text)
    local newValue = tonumber(text)
    if newValue and newValue > 0 then
        targetRebirthValue = newValue
        updateStats()
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Objetivo Actualizado",
            Text = "Nuevo objetivo: " .. tostring(targetRebirthValue) .. " renacimientos",
            Duration = 3
        })
    else
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Size",
            Text = "Put a size larger than 0",
            Duration = 3
        })
    end
end)

local infiniteSwitch

local targetSwitch = rebirths:AddSwitch("Auto Rebirth Target", function(bool)
    _G.targetRebirthActive = bool

    if bool then
        if _G.infiniteRebirthActive and infiniteSwitch then
            infiniteSwitch:Set(false)
            _G.infiniteRebirthActive = false
        end

        spawn(function()
            while _G.targetRebirthActive and wait(0.1) do
                local currentRebirths = game.Players.LocalPlayer.leaderstats.Rebirths.Value

                if currentRebirths >= targetRebirthValue then
                    targetSwitch:Set(false)
                    _G.targetRebirthActive = false

                    game:GetService("StarterGui"):SetCore("SendNotification", {
                        Title = "Objetivo Alcanzado!",
                        Text = "Has alcanzado " .. tostring(targetRebirthValue) .. " renacimientos",
                        Duration = 5
                    })

                    break
                end

                pcall(function()
                    game:GetService("ReplicatedStorage").rEvents.rebirthRemote:InvokeServer("rebirthRequest")
                end)
            end
        end)
    end
end, "automatic rebirth until reaching the goal")

infiniteSwitch = rebirths:AddSwitch("Auto Rebirth (Infinitely)", function(bool)
    _G.infiniteRebirthActive = bool

    if bool then
        if _G.targetRebirthActive and targetSwitch then
            targetSwitch:Set(false)
            _G.targetRebirthActive = false
        end

        spawn(function()
            while _G.infiniteRebirthActive and wait(0.1) do
                pcall(function()
                    game:GetService("ReplicatedStorage").rEvents.rebirthRemote:InvokeServer("rebirthRequest")
                end)
            end
        end)
    end
end, "rebirth infinitely")

local sizeSwitch = rebirths:AddSwitch("Auto Size 1", function(bool)
    _G.autoSizeActive = bool

    if bool then
        spawn(function()
            while _G.autoSizeActive and wait() do
                pcall(function()
                    game:GetService("ReplicatedStorage").rEvents.changeSpeedSizeRemote:InvokeServer("changeSize", 1)
                end)
            end
        end)
    end
end, "Size 1")

local teleportSwitch = rebirths:AddSwitch("Auto Teleport to Muscle King", function(bool)
    _G.teleportActive = bool

    if bool then
        spawn(function()
            while _G.teleportActive and wait() do
                if game.Players.LocalPlayer.Character then
                    game.Players.LocalPlayer.Character:MoveTo(Vector3.new(-8646, 17, -5738))
                end
            end
        end)
    end
end, "Tp to Mk")

local autoEquipToolsFolder = rebirths:AddFolder("Auto Equip Tools")

autoEquipToolsFolder:AddButton("Gamepass AutoLift", function()
    local gamepassFolder = game:GetService("ReplicatedStorage").gamepassIds
    local player = game:GetService("Players").LocalPlayer
    for _, gamepass in pairs(gamepassFolder:GetChildren()) do
        local value = Instance.new("IntValue")
        value.Name = gamepass.Name
        value.Value = gamepass.Value
        value.Parent = player:FindFirstChild("ownedGamepasses") or player
    end
end, "Unlock AutoLift Passe")

autoEquipToolsFolder:AddSwitch("Auto Weight", function(Value)
    _G.AutoWeight = Value

    if Value then
        local weightTool = game.Players.LocalPlayer.Backpack:FindFirstChild("Weight")
        if weightTool and game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
            game.Players.LocalPlayer.Character.Humanoid:EquipTool(weightTool)
        end
    else
        local character = game.Players.LocalPlayer.Character
        if character then
            local equipped = character:FindFirstChild("Weight")
            if equipped then
                equipped.Parent = game.Players.LocalPlayer.Backpack
            end
        end
    end

    task.spawn(function()
        while _G.AutoWeight do
            if not _G.AutoWeight then break end
            pcall(function()
                game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
            end)
            task.wait(0.1)
        end
    end)
end, "Auto Weight")

autoEquipToolsFolder:AddSwitch("Auto Pushups", function(Value)
    _G.AutoPushups = Value

    if Value then
        local pushupsTool = game.Players.LocalPlayer.Backpack:FindFirstChild("Pushups")
        if pushupsTool and game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
            game.Players.LocalPlayer.Character.Humanoid:EquipTool(pushupsTool)
        end
    else
        local character = game.Players.LocalPlayer.Character
        if character then
            local equipped = character:FindFirstChild("Pushups")
            if equipped then
                equipped.Parent = game.Players.LocalPlayer.Backpack
            end
        end
    end

    task.spawn(function()
        while _G.AutoPushups do
            if not _G.AutoPushups then break end
            pcall(function()
                game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
            end)
            task.wait(0.1)
        end
    end)
end, "Auto Pushups")

autoEquipToolsFolder:AddSwitch("Auto Handstands", function(Value)
    _G.AutoHandstands = Value

    if Value then
        local handstandsTool = game.Players.LocalPlayer.Backpack:FindFirstChild("Handstands")
        if handstandsTool and game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
            game.Players.LocalPlayer.Character.Humanoid:EquipTool(handstandsTool)
        end
    else
        local character = game.Players.LocalPlayer.Character
        if character then
            local equipped = character:FindFirstChild("Handstands")
            if equipped then
                equipped.Parent = game.Players.LocalPlayer.Backpack
            end
        end
    end

    task.spawn(function()
        while _G.AutoHandstands do
            if not _G.AutoHandstands then break end
            pcall(function()
                game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
            end)
            task.wait(0.1)
        end
    end)
end, "Auto Handstands")

autoEquipToolsFolder:AddSwitch("Auto Situps", function(Value)
    _G.AutoSitups = Value

    if Value then
        local situpsTool = game.Players.LocalPlayer.Backpack:FindFirstChild("Situps")
        if situpsTool and game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
            game.Players.LocalPlayer.Character.Humanoid:EquipTool(situpsTool)
        end
    else
        local character = game.Players.LocalPlayer.Character
        if character then
            local equipped = character:FindFirstChild("Situps")
            if equipped then
                equipped.Parent = game.Players.LocalPlayer.Backpack
            end
        end
    end

    task.spawn(function()
        while _G.AutoSitups do
            if not _G.AutoSitups then break end
            pcall(function()
                game:GetService("Players").LocalPlayer.muscleEvent:FireServer("rep")
            end)
            task.wait(0.1)
        end
    end)
end, "Auto Abdominals")

autoEquipToolsFolder:AddSwitch("Auto Punch", function(Value)
    _G.fastHitActive = Value

    if Value then
        task.spawn(function()
            while _G.fastHitActive do
                if not _G.fastHitActive then break end

                local player = game.Players.LocalPlayer
                local punch = player.Backpack:FindFirstChild("Punch")
                if punch then
                    punch.Parent = player.Character
                    if punch:FindFirstChild("attackTime") then
                        punch.attackTime.Value = 0
                    end
                end
                task.wait(0.1)
            end
        end)

        task.spawn(function()
            while _G.fastHitActive do
                if not _G.fastHitActive then break end

                local player = game.Players.LocalPlayer
                pcall(function()
                    player.muscleEvent:FireServer("punch", "rightHand")
                    player.muscleEvent:FireServer("punch", "leftHand")
                end)

                local character = player.Character
                if character then
                    local punchTool = character:FindFirstChild("Punch")
                    if punchTool and punchTool.Activate then
                        pcall(function() punchTool:Activate() end)
                    end
                end
                task.wait(0)
            end
        end)
    else
        local character = game.Players.LocalPlayer.Character
        if character then
            local equipped = character:FindFirstChild("Punch")
            if equipped then
                equipped.Parent = game.Players.LocalPlayer.Backpack
            end
        end
    end
end, "Auto Punch")

autoEquipToolsFolder:AddSwitch("Fast Tools", function(Value)
    _G.FastTools = Value

    local defaultSpeeds = {
        { "Punch", "attackTime", Value and 0 or 0.35 },
        { "Ground Slam", "attackTime", Value and 0 or 6 },
        { "Stomp", "attackTime", Value and 0 or 7 },
        { "Handstands", "repTime", Value and 0 or 1 },
        { "Pushups", "repTime", Value and 0 or 1 },
        { "Weight", "repTime", Value and 0 or 1 },
        { "Situps", "repTime", Value and 0 or 1 }
    }

    local player = game.Players.LocalPlayer
    local backpack = player:WaitForChild("Backpack")

    for _, toolInfo in ipairs(defaultSpeeds) do
        local tool = backpack:FindFirstChild(toolInfo[1])
        if tool and tool:FindFirstChild(toolInfo[2]) then
            pcall(function() tool[toolInfo[2]].Value = toolInfo[3] end)
        end

        local equippedTool = player.Character and player.Character:FindFirstChild(toolInfo[1])
        if equippedTool and equippedTool:FindFirstChild(toolInfo[2]) then
            pcall(function() equippedTool[toolInfo[2]].Value = toolInfo[3] end)
        end
    end
end, "Speed up all tools")

local sessionStartTime = os.time()
local sessionStartStrength = 0
local sessionStartDurability = 0
local sessionStartKills = 0
local sessionStartRebirths = 0
local sessionStartBrawls = 0
local hasStartedTracking = false

-- Kill tab & player-related variables (single Players/LocalPlayer declaration)
local Killer = window:AddTab("Kill")

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local playerWhitelist = {}
local targetPlayerNames = {}
local autoGoodKarma = false
local autoBadKarma = false
local autoKill = false
local killTarget = false
local spying = false
local autoEquipPunch = false
local autoPunchNoAnim = false
local targetDropdownItems = {}
local availableTargets = {}

Killer:AddSwitch("Auto Good Karma", function(bool)
    autoGoodKarma = bool
    task.spawn(function()
        while autoGoodKarma do
            local playerChar = LocalPlayer.Character
            local rightHand = playerChar and playerChar:FindFirstChild("RightHand")
            local leftHand = playerChar and playerChar:FindFirstChild("LeftHand")
            if playerChar and rightHand and leftHand then
                for _, target in ipairs(Players:GetPlayers()) do
                    if target ~= LocalPlayer then
                        local evilKarma = target:FindFirstChild("evilKarma")
                        local goodKarma = target:FindFirstChild("goodKarma")
                        if evilKarma and goodKarma and evilKarma:IsA("IntValue") and goodKarma:IsA("IntValue") and evilKarma.Value > goodKarma.Value then
                            local rootPart = target.Character and target.Character:FindFirstChild("HumanoidRootPart")
                            if rootPart then
                                pcall(function()
                                    firetouchinterest(rightHand, rootPart, 1)
                                    firetouchinterest(leftHand, rootPart, 1)
                                    firetouchinterest(rightHand, rootPart, 0)
                                    firetouchinterest(leftHand, rootPart, 0)
                                end)
                            end
                        end
                    end
                end
            end
            task.wait(0.01)
        end
    end)
end)

Killer:AddSwitch("Auto Bad Karma", function(bool)
    autoBadKarma = bool
    task.spawn(function()
        while autoBadKarma do
            local playerChar = LocalPlayer.Character
            local rightHand = playerChar and playerChar:FindFirstChild("RightHand")
            local leftHand = playerChar and playerChar:FindFirstChild("LeftHand")
            if playerChar and rightHand and leftHand then
                for _, target in ipairs(Players:GetPlayers()) do
                    if target ~= LocalPlayer then
                        local evilKarma = target:FindFirstChild("evilKarma")
                        local goodKarma = target:FindFirstChild("goodKarma")
                        if evilKarma and goodKarma and evilKarma:IsA("IntValue") and goodKarma:IsA("IntValue") and goodKarma.Value > evilKarma.Value then
                            local rootPart = target.Character and target.Character:FindFirstChild("HumanoidRootPart")
                            if rootPart then
                                pcall(function()
                                    firetouchinterest(rightHand, rootPart, 1)
                                    firetouchinterest(leftHand, rootPart, 1)
                                    firetouchinterest(rightHand, rootPart, 0)
                                    firetouchinterest(leftHand, rootPart, 0)
                                end)
                            end
                        end
                    end
                end
            end
            task.wait(0.01)
        end
    end)
end)

local friendWhitelistActive = false

Killer:AddSwitch("Auto Whitelist Friends", function(state)
    friendWhitelistActive = state

    if state then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and LocalPlayer:IsFriendsWith(player.UserId) then
                playerWhitelist[player.Name] = true
            end
        end

        Players.PlayerAdded:Connect(function(player)
            if friendWhitelistActive and player ~= LocalPlayer and LocalPlayer:IsFriendsWith(player.UserId) then
                playerWhitelist[player.Name] = true
            end
        end)
    else
        for name in pairs(playerWhitelist) do
            local friend = Players:FindFirstChild(name)
            if friend and LocalPlayer:IsFriendsWith(friend.UserId) then
                playerWhitelist[name] = nil
            end
        end
    end
end)

Killer:AddTextBox("Whitelist", function(text)
    local target = Players:FindFirstChild(text)
    if target then
        playerWhitelist[target.Name] = true
    end
end)

Killer:AddTextBox("UnWhitelist", function(text)
    local target = Players:FindFirstChild(text)
    if target then
        playerWhitelist[target.Name] = nil
    end
end)

Killer:AddSwitch("Auto Kill", function(bool)
    autoKill = bool

    task.spawn(function()
        while autoKill do
            local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
            local rightHand = character:FindFirstChild("RightHand")
            local leftHand = character:FindFirstChild("LeftHand")

            local punch = LocalPlayer.Backpack:FindFirstChild("Punch")
            if punch and not character:FindFirstChild("Punch") then
                punch.Parent = character
            end

            if rightHand and leftHand then
                for _, target in ipairs(Players:GetPlayers()) do
                    if target ~= LocalPlayer and not playerWhitelist[target.Name] then
                        local targetChar = target.Character
                        local rootPart = targetChar and targetChar:FindFirstChild("HumanoidRootPart")
                        if rootPart then
                            pcall(function()
                                firetouchinterest(rightHand, rootPart, 1)
                                firetouchinterest(leftHand, rootPart, 1)
                                firetouchinterest(rightHand, rootPart, 0)
                                firetouchinterest(leftHand, rootPart, 0)
                            end)
                        end
                    end
                end
            end

            task.wait(0.05)
        end
    end)
end)

local targetDropdown = Killer:AddDropdown("Select Target", function(name)
    if name and not table.find(targetPlayerNames, name) then
        table.insert(targetPlayerNames, name)
    end
end)

Killer:AddTextBox("Remove Target", function(name)
    for i, v in ipairs(targetPlayerNames) do
        if v == name then
            table.remove(targetPlayerNames, i)
            break
        end
    end
end)

for _, player in ipairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        targetDropdown:Add(player.Name)
        targetDropdownItems[player.Name] = true
    end
end

Players.PlayerAdded:Connect(function(player)
    if player ~= LocalPlayer then
        targetDropdown:Add(player.Name)
        targetDropdownItems[player.Name] = true
    end
end)

Players.PlayerRemoving:Connect(function(player)
    if targetDropdownItems[player.Name] then
        targetDropdownItems[player.Name] = nil
        targetDropdown:Clear()
        for name in pairs(targetDropdownItems) do
            targetDropdown:Add(name)
        end
    end

    for i = #targetPlayerNames, 1, -1 do
        if targetPlayerNames[i] == player.Name then
            table.remove(targetPlayerNames, i)
        end
    end
end)

Killer:AddSwitch("Start Kill Target", function(state)
    killTarget = state

    task.spawn(function()
        while killTarget do
            local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()

            local punch = LocalPlayer.Backpack:FindFirstChild("Punch")
            if punch and not character:FindFirstChild("Punch") then
                punch.Parent = character
            end

            local rightHand = character:WaitForChild("RightHand", 5)
            local leftHand = character:WaitForChild("LeftHand", 5)

            if rightHand and leftHand then
                for _, name in ipairs(targetPlayerNames) do
                    local target = Players:FindFirstChild(name)
                    if target and target ~= LocalPlayer then
                        local rootPart = target.Character and target.Character:FindFirstChild("HumanoidRootPart")
                        if rootPart then
                            pcall(function()
                                firetouchinterest(rightHand, rootPart, 1)
                                firetouchinterest(leftHand, rootPart, 1)
                                firetouchinterest(rightHand, rootPart, 0)
                                firetouchinterest(leftHand, rootPart, 0)
                            end)
                        end
                    end
                end
            end

            task.wait(0.05)
        end
    end)
end)

local spyTargetDropdown = Killer:AddDropdown("Select View Target", function(name)
    targetPlayerName = name
end)

for _, player in ipairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        spyTargetDropdown:Add(player.Name)
    end
end

Players.PlayerAdded:Connect(function(player)
    if player ~= LocalPlayer then
        spyTargetDropdown:Add(player.Name)
    end
end)

Players.PlayerRemoving:Connect(function(player)
    if player ~= LocalPlayer then
        spyTargetDropdown:Clear()
        for _, plr in ipairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer then
                spyTargetDropdown:Add(plr.Name)
            end
        end
    end
end)

-- End of file. If you'd like, I can:
-- - Make a pull request with this change,
-- - Or produce a minimal patch diff you can apply,
-- - Or further harden/optimize any specific sections (e.g., debounce, anti-kick checks).